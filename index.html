<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>StarPay ‚Äî –ü–æ–∫—É–ø–∫–∞ Telegram Stars</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Roboto+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
    <style>
        /* –ú–æ–Ω–æ—Ö—Ä–æ–º–Ω–∞—è —á–µ—Ä–Ω–æ-–±–µ–ª–∞—è —Ç–µ–º–∞ */
        :root {
            --tg-bg-color: #FFFFFF;
            --tg-secondary-bg-color: #F8F8F8;
            --tg-text-color: #000000;
            --tg-secondary-text-color: #666666;
            --tg-hint-color: #999999;
            --tg-link-color: #000000;
            --tg-button-color: #000000;
            --tg-button-text-color: #FFFFFF;
            --tg-border-color: #E0E0E0;
            --tg-card-bg: #FFFFFF;
            --tg-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            --tg-input-bg: #FFFFFF;
            
            /* –ê–∫—Ü–µ–Ω—Ç–Ω—ã–µ —Ü–≤–µ—Ç–∞ (—á–µ—Ä–Ω–æ-–±–µ–ª—ã–µ) */
            --primary-black: #000000;
            --secondary-black: #333333;
            --primary-white: #FFFFFF;
            --secondary-gray: #F0F0F0;
            --success-color: #10B981;
            --error-color: #EF4444;
            --warning-color: #F59E0B;
            --info-color: #3B82F6;
            --radius-lg: 16px;
            --radius-md: 12px;
            --radius-sm: 8px;
        }
        
        .theme-dark {
            --tg-bg-color: #000000;
            --tg-secondary-bg-color: #1A1A1A;
            --tg-text-color: #FFFFFF;
            --tg-secondary-text-color: #CCCCCC;
            --tg-hint-color: #888888;
            --tg-link-color: #FFFFFF;
            --tg-button-color: #FFFFFF;
            --tg-button-text-color: #000000;
            --tg-border-color: #333333;
            --tg-card-bg: #1A1A1A;
            --tg-shadow: 0 2px 12px rgba(255, 255, 255, 0.1);
            --tg-input-bg: #2A2A2A;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--tg-bg-color);
            color: var(--tg-text-color);
            line-height: 1.6;
            min-height: 100vh;
            transition: background-color 0.3s ease, color 0.3s ease;
            padding-bottom: 80px;
        }
        
        .container {
            max-width: 100%;
            padding: 16px;
            margin: 0 auto;
        }
        
        /* –®–∞–ø–∫–∞ */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 0;
            margin-bottom: 16px;
            border-bottom: 1px solid var(--tg-border-color);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 22px;
            font-weight: 800;
            color: var(--tg-text-color);
            text-decoration: none;
        }
        
        .logo-icon {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--primary-black) 0%, var(--secondary-black) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
        }
        
        .theme-dark .logo-icon {
            background: linear-gradient(135deg, var(--primary-white) 0%, var(--secondary-gray) 100%);
            color: black;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .balance {
            background: var(--tg-card-bg);
            border: 1px solid var(--tg-border-color);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            font-weight: 700;
            font-size: 20px;
            color: var(--tg-text-color);
            box-shadow: var(--tg-shadow);
        }
        
        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */
        .main-content {
            padding-bottom: 20px;
        }
        
        .section {
            background: var(--tg-card-bg);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 16px;
            border: 1px solid var(--tg-border-color);
            box-shadow: var(--tg-shadow);
        }
        
        .section-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--tg-text-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            color: var(--tg-text-color);
            font-size: 22px;
        }
        
        /* –¢–∞–±—ã */
        .tabs {
            display: flex;
            gap: 8px;
            background: var(--tg-secondary-bg-color);
            padding: 6px;
            border-radius: var(--radius-md);
            margin-bottom: 20px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .tab {
            flex: 0 0 auto;
            padding: 12px 16px;
            border: none;
            background: transparent;
            font-family: 'Inter', sans-serif;
            font-weight: 600;
            font-size: 14px;
            color: var(--tg-secondary-text-color);
            border-radius: var(--radius-sm);
            cursor: pointer;
            text-align: center;
            white-space: nowrap;
            transition: all 0.2s ease;
        }
        
        .tab.active {
            background: var(--tg-card-bg);
            color: var(--tg-text-color);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .theme-dark .tab.active {
            box-shadow: 0 2px 8px rgba(255, 255, 255, 0.1);
        }
        
        /* –ö—É—Ä—Å –≤–∞–ª—é—Ç */
        .rate-info {
            background: var(--tg-secondary-bg-color);
            border-radius: var(--radius-md);
            padding: 16px;
            margin-bottom: 20px;
            text-align: center;
            border: 1px solid var(--tg-border-color);
        }
        
        .rate-title {
            font-size: 14px;
            color: var(--tg-secondary-text-color);
            margin-bottom: 8px;
        }
        
        .rate-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--tg-text-color);
        }
        
        /* –§–æ—Ä–º—ã */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 15px;
            color: var(--tg-text-color);
        }
        
        .form-input {
            width: 100%;
            padding: 16px;
            background: var(--tg-input-bg);
            border: 2px solid var(--tg-border-color);
            border-radius: var(--radius-md);
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            color: var(--tg-text-color);
            transition: all 0.2s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--tg-text-color);
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1);
        }
        
        .theme-dark .form-input:focus {
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.1);
        }
        
        .form-hint {
            display: block;
            margin-top: 6px;
            font-size: 13px;
            color: var(--tg-hint-color);
        }
        
        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            width: 100%;
            padding: 18px;
            background: var(--tg-button-color);
            color: var(--tg-button-text-color);
            border: none;
            border-radius: var(--radius-md);
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }
        
        .theme-dark .btn:hover {
            box-shadow: 0 8px 25px rgba(255, 255, 255, 0.2);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-secondary {
            background: var(--tg-secondary-bg-color);
            color: var(--tg-text-color);
            border: 1px solid var(--tg-border-color);
        }
        
        /* –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ */
        .calculation {
            background: var(--tg-secondary-bg-color);
            border-radius: var(--radius-md);
            padding: 16px;
            margin-bottom: 20px;
        }
        
        .calculation-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 15px;
        }
        
        .calculation-row.total {
            font-size: 18px;
            font-weight: 700;
            border-top: 1px solid var(--tg-border-color);
            padding-top: 12px;
            margin-top: 12px;
        }
        
        /* –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π */
        .history-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .history-item {
            background: var(--tg-card-bg);
            border: 1px solid var(--tg-border-color);
            border-radius: var(--radius-md);
            padding: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: transform 0.2s ease;
        }
        
        .history-item:hover {
            transform: translateY(-2px);
        }
        
        .history-info {
            flex: 1;
        }
        
        .history-title {
            font-weight: 600;
            font-size: 16px;
            color: var(--tg-text-color);
            margin-bottom: 4px;
        }
        
        .history-subtitle {
            font-size: 14px;
            color: var(--tg-secondary-text-color);
        }
        
        .history-amount {
            font-weight: 700;
            font-size: 18px;
        }
        
        .history-amount.positive {
            color: var(--success-color);
        }
        
        .history-amount.negative {
            color: var(--error-color);
        }
        
        .history-status {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 20px;
            margin-top: 4px;
            display: inline-block;
        }
        
        .status-success {
            background: rgba(16, 185, 129, 0.15);
            color: var(--success-color);
        }
        
        .status-pending {
            background: rgba(245, 158, 11, 0.15);
            color: var(--warning-color);
        }
        
        .status-error {
            background: rgba(239, 68, 68, 0.15);
            color: var(--error-color);
        }
        
        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(-100%);
            background: var(--tg-card-bg);
            border: 1px solid var(--tg-border-color);
            border-radius: var(--radius-md);
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            max-width: 90%;
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(-50%) translateY(0);
        }
        
        .notification-icon {
            font-size: 24px;
        }
        
        .notification-content {
            flex: 1;
        }
        
        .notification-title {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 4px;
        }
        
        .notification-text {
            font-size: 14px;
            color: var(--tg-secondary-text-color);
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        
        .modal.show {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: var(--tg-card-bg);
            border-radius: var(--radius-lg);
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }
        
        .modal.show .modal-content {
            transform: translateY(0);
        }
        
        .modal-header {
            padding: 20px;
            background: var(--tg-button-color);
            color: var(--tg-button-text-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 20px;
            font-weight: 700;
        }
        
        .modal-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: var(--tg-button-text-color);
            width: 36px;
            height: 36px;
            border-radius: 10px;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-body {
            padding: 20px;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        /* –§—É—Ç–µ—Ä */
        .footer {
            margin-top: 32px;
            padding-top: 20px;
            border-top: 1px solid var(--tg-border-color);
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .footer-link {
            color: var(--tg-link-color);
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
        }
        
        .footer-text {
            text-align: center;
            margin-top: 16px;
            font-size: 13px;
            color: var(--tg-hint-color);
        }
        
        /* –ó–≤–µ–∑–¥—ã */
        .stars-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 24px;
            margin-bottom: 20px;
        }
        
        .star-icon {
            color: #FFD700;
        }
        
        /* –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä */
        .calculator {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }
        
        .calc-btn {
            padding: 12px;
            background: var(--tg-secondary-bg-color);
            border: 1px solid var(--tg-border-color);
            border-radius: var(--radius-sm);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s ease;
        }
        
        .calc-btn:hover {
            background: var(--tg-border-color);
        }
        
        .calc-btn.active {
            background: var(--tg-button-color);
            color: var(--tg-button-text-color);
        }
        
        /* –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –ø—É—Å—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–∏ */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
        }
        
        .empty-state i {
            font-size: 48px;
            color: var(--tg-hint-color);
            margin-bottom: 16px;
            opacity: 0.5;
        }
        
        .empty-state p {
            color: var(--tg-secondary-text-color);
            font-size: 16px;
        }
        
        /* –°–∫—Ä—ã—Ç—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã */
        .hidden {
            display: none !important;
        }
        
        /* –£—Ç–∏–ª–∏—Ç—ã –æ—Ç—Å—Ç—É–ø–æ–≤ */
        .mt-2 { margin-top: 8px; }
        .mt-3 { margin-top: 12px; }
        .mt-4 { margin-top: 16px; }
        .mb-2 { margin-bottom: 8px; }
        .mb-3 { margin-bottom: 12px; }
        .mb-4 { margin-bottom: 16px; }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 480px) {
            .container {
                padding: 12px;
            }
            
            .section {
                padding: 16px;
            }
            
            .tab {
                padding: 10px 12px;
                font-size: 13px;
            }
            
            .modal-body {
                padding: 16px;
            }
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease forwards;
        }
    </style>
</head>
<body>
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ -->
    <div id="agreementModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ</div>
                <button class="modal-close" onclick="closeModal('agreementModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="document-content">
                    <h3>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ StarPay</h3>
                    <p><strong>–î–∞—Ç–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ —Å–∏–ª—É:</strong> 1 —è–Ω–≤–∞—Ä—è 2026 –≥–æ–¥–∞</p>
                    
                    <h4>1. –û–±—â–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è</h4>
                    <p>StarPay - —Å–µ—Ä–≤–∏—Å –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –∏ –æ–±–º–µ–Ω–∞ Telegram Stars.</p>
                    
                    <h4>2. –ö—É—Ä—Å –æ–±–º–µ–Ω–∞</h4>
                    <p>1 Telegram Star = 1.1 RUB. –ö—É—Ä—Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å—Å—è —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.</p>
                    
                    <h4>3. –ü–æ–∫—É–ø–∫–∞ Stars</h4>
                    <p>–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø–æ–∫—É–ø–∫–∞: 10 Stars. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–æ–∫—É–ø–∫–∞: 100,000 Stars.</p>
                    
                    <h4>4. –ö–æ–º–∏—Å—Å–∏–∏</h4>
                    <p>–ö–æ–º–∏—Å—Å–∏—è –∑–∞ –ø–æ–∫—É–ø–∫—É: 1.5% –æ—Ç —Å—É–º–º—ã.</p>
                    <p>–°—Ä–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞—è–≤–æ–∫: 1-7 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π.</p>
                    
                    <h4>5. –ö–æ–Ω—Ç–∞–∫—Ç—ã</h4>
                    <p>–ü–æ–¥–¥–µ—Ä–∂–∫–∞: starpay@mail.ru</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="notification" class="notification">
        <div class="notification-icon" id="notification-icon">üí´</div>
        <div class="notification-content">
            <div class="notification-title" id="notification-title">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</div>
            <p class="notification-text" id="notification-text">–¢–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</p>
        </div>
    </div>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
    <div class="container">
        <!-- –®–∞–ø–∫–∞ -->
        <div class="header">
            <div class="logo">
                <div class="logo-icon">‚òÖ</div>
                <span>StarPay</span>
            </div>
            <div class="user-info">
                <div class="balance" id="balance">0 ‚ÇΩ</div>
            </div>
        </div>
        
        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="main-content">
            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫—É—Ä—Å–µ -->
            <div class="rate-info">
                <div class="rate-title">–ö—É—Ä—Å Telegram Stars</div>
                <div class="rate-value">1 STAR = 1.1 ‚ÇΩ</div>
            </div>
            
            <!-- –¢–∞–±—ã –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
            <div class="tabs">
                <button class="tab active" onclick="showTab('buy')">–ö—É–ø–∏—Ç—å Stars</button>
                <button class="tab" onclick="showTab('history')">–ò—Å—Ç–æ—Ä–∏—è</button>
                <button class="tab" onclick="showTab('about')">–û —Å–µ—Ä–≤–∏—Å–µ</button>
            </div>
            
            <!-- –ü–æ–∫—É–ø–∫–∞ Stars -->
            <div id="buy-tab" class="section fade-in">
                <div class="section-title">
                    <i class="fas fa-star"></i>
                    <span>–ü–æ–∫—É–ø–∫–∞ Telegram Stars</span>
                </div>
                
                <!-- –ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä -->
                <div class="calculator">
                    <div class="calc-btn" onclick="setStarsAmount(100)">100</div>
                    <div class="calc-btn" onclick="setStarsAmount(500)">500</div>
                    <div class="calc-btn" onclick="setStarsAmount(1000)">1000</div>
                    <div class="calc-btn" onclick="setStarsAmount(5000)">5000</div>
                </div>
                
                <form id="buy-form">
                    <div class="form-group">
                        <label class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ Stars</label>
                        <input type="number" class="form-input" id="stars-amount" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ" min="10" max="100000" value="100" required>
                        <span class="form-hint">–ú–∏–Ω–∏–º—É–º: 10 Stars, –º–∞–∫—Å–∏–º—É–º: 100,000 Stars</span>
                    </div>
                    
                    <!-- –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ -->
                    <div class="calculation">
                        <div class="calculation-row">
                            <span>–°—Ç–æ–∏–º–æ—Å—Ç—å Stars:</span>
                            <span id="stars-cost">110.00 ‚ÇΩ</span>
                        </div>
                        <div class="calculation-row">
                            <span>–ö–æ–º–∏—Å—Å–∏—è (1.5%):</span>
                            <span id="commission">1.65 ‚ÇΩ</span>
                        </div>
                        <div class="calculation-row total">
                            <span>–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ:</span>
                            <span id="total-cost">111.65 ‚ÇΩ</span>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn">
                        <i class="fas fa-shopping-cart"></i>
                        –ö—É–ø–∏—Ç—å Stars
                    </button>
                </form>
                
                <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–∫—É–ø–∫–∏ -->
                <div id="buy-result" class="section mt-4 hidden">
                    <div class="section-title">
                        <i class="fas fa-check-circle" style="color: var(--success-color);"></i>
                        <span>Stars –∫—É–ø–ª–µ–Ω—ã!</span>
                    </div>
                    <div class="stars-display">
                        <i class="fas fa-star star-icon"></i>
                        <span id="purchased-stars">100</span>
                        <span>Stars</span>
                    </div>
                    <div style="text-align: center; margin-bottom: 20px; color: var(--tg-secondary-text-color);">
                        –ù–∞ –≤–∞—à –±–∞–ª–∞–Ω—Å –∑–∞—á–∏—Å–ª–µ–Ω–æ
                    </div>
                    <button class="btn btn-secondary" onclick="showTab('history')">
                        <i class="fas fa-history"></i>
                        –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å—Ç–æ—Ä–∏—é
                    </button>
                </div>
            </div>
            
            <!-- –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π -->
            <div id="history-tab" class="section fade-in hidden">
                <div class="section-title">
                    <i class="fas fa-history"></i>
                    <span>–ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫</span>
                </div>
                
                <div id="history-list">
                    <div class="empty-state">
                        <i class="fas fa-star"></i>
                        <p>–ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫ –ø—É—Å—Ç–∞</p>
                        <p class="text-muted mt-2">–ö—É–ø–∏—Ç–µ —Å–≤–æ–∏ –ø–µ—Ä–≤—ã–µ Telegram Stars</p>
                    </div>
                </div>
            </div>
            
            <!-- –û —Å–µ—Ä–≤–∏—Å–µ -->
            <div id="about-tab" class="section fade-in hidden">
                <div class="section-title">
                    <i class="fas fa-info-circle"></i>
                    <span>–û —Å–µ—Ä–≤–∏—Å–µ StarPay</span>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="margin-bottom: 12px; font-size: 18px;">–ß—Ç–æ —Ç–∞–∫–æ–µ Telegram Stars?</h4>
                    <p style="color: var(--tg-secondary-text-color); margin-bottom: 16px;">
                        Telegram Stars ‚Äî —ç—Ç–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –≤–∞–ª—é—Ç–∞ Telegram, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ–∫—É–ø–∫–∏ —Ü–∏—Ñ—Ä–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤, –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∞–≤—Ç–æ—Ä–æ–≤ –∏ –æ–ø–ª–∞—Ç—ã —É—Å–ª—É–≥ –≤ –±–æ—Ç–æ–≤—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö.
                    </p>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 20px;">
                    <div style="text-align: center; padding: 16px; background: var(--tg-secondary-bg-color); border-radius: var(--radius-md);">
                        <i class="fas fa-bolt" style="font-size: 24px; color: var(--tg-text-color); margin-bottom: 8px;"></i>
                        <div style="font-weight: 600; font-size: 14px; margin-bottom: 4px;">–ú–≥–Ω–æ–≤–µ–Ω–Ω–æ</div>
                        <div style="font-size: 12px; color: var(--tg-secondary-text-color);">–ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –∑–∞—á–∏—Å–ª–µ–Ω–∏–µ</div>
                    </div>
                    
                    <div style="text-align: center; padding: 16px; background: var(--tg-secondary-bg-color); border-radius: var(--radius-md);">
                        <i class="fas fa-shield-alt" style="font-size: 24px; color: var(--tg-text-color); margin-bottom: 8px;"></i>
                        <div style="font-weight: 600; font-size: 14px; margin-bottom: 4px;">–ë–µ–∑–æ–ø–∞—Å–Ω–æ</div>
                        <div style="font-size: 12px; color: var(--tg-secondary-text-color);">–ó–∞—â–∏—Ç–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</div>
                    </div>
                    
                    <div style="text-align: center; padding: 16px; background: var(--tg-secondary-bg-color); border-radius: var(--radius-md);">
                        <i class="fas fa-percent" style="font-size: 24px; color: var(--tg-text-color); margin-bottom: 8px;"></i>
                        <div style="font-weight: 600; font-size: 14px; margin-bottom: 4px;">–ù–∏–∑–∫–∞—è –∫–æ–º–∏—Å—Å–∏—è</div>
                        <div style="font-size: 12px; color: var(--tg-secondary-text-color);">–í—Å–µ–≥–æ 1.5%</div>
                    </div>
                    
                    <div style="text-align: center; padding: 16px; background: var(--tg-secondary-bg-color); border-radius: var(--radius-md);">
                        <i class="fas fa-headset" style="font-size: 24px; color: var(--tg-text-color); margin-bottom: 8px;"></i>
                        <div style="font-weight: 600; font-size: 14px; margin-bottom: 4px;">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</div>
                        <div style="font-size: 12px; color: var(--tg-secondary-text-color);">24/7 –ø–æ–¥–¥–µ—Ä–∂–∫–∞</div>
                    </div>
                </div>
                
                <div style="background: var(--tg-secondary-bg-color); border-radius: var(--radius-md); padding: 16px;">
                    <h4 style="margin-bottom: 12px; font-size: 16px;">–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Stars?</h4>
                    <ul style="color: var(--tg-secondary-text-color); padding-left: 20px;">
                        <li style="margin-bottom: 8px;">–ü–æ–∫—É–ø–∫–∞ —Ü–∏—Ñ—Ä–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤</li>
                        <li style="margin-bottom: 8px;">–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–≤—Ç–æ—Ä–æ–≤ –∫–∞–Ω–∞–ª–æ–≤</li>
                        <li style="margin-bottom: 8px;">–û–ø–ª–∞—Ç–∞ —É—Å–ª—É–≥ –≤ –±–æ—Ç–∞—Ö</li>
                        <li>–ü–æ–∫—É–ø–∫–∞ –ø—Ä–µ–º–∏—É–º-–ø–æ–¥–ø–∏—Å–æ–∫</li>
                    </ul>
                </div>
            </div>
            
            <!-- –§—É—Ç–µ—Ä -->
            <div class="footer">
                <div class="footer-links">
                    <a href="#" class="footer-link" onclick="openModal('agreementModal'); return false;">–°–æ–≥–ª–∞—à–µ–Ω–∏–µ</a>
                    <a href="#" class="footer-link" onclick="showNotification('–ü–æ–¥–¥–µ—Ä–∂–∫–∞', '–ü–æ –≤—Å–µ–º –≤–æ–ø—Ä–æ—Å–∞–º: starpay@mail.ru', 'info'); return false;">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</a>
                    <a href="#" class="footer-link" onclick="showTab('about'); return false;">–û —Å–µ—Ä–≤–∏—Å–µ</a>
                </div>
                <div class="footer-text">
                    ¬© 2025 StarPay. –ù–µ–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è –ø–æ–∫—É–ø–∫–∏ Telegram Stars
                </div>
            </div>
        </div>
    </div>

    <script>
    // Telegram WebApp API
    let tg = window.Telegram.WebApp;
    
    // Firebase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
    const firebaseConfig = {
        apiKey: "AIzaSyBaxoVYKmWtLgmTcM0AS5acQ1TN8qKyFfA",
        authDomain: "cashcheck-7e5c6.firebaseapp.com",
        projectId: "cashcheck-7e5c6",
        storageBucket: "cashcheck-7e5c6.firebasestorage.app",
        messagingSenderId: "706696825244",
        appId: "1:706696825244:web:e8de79e5cdae5df9606059"
    };
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
    let app, db;
    try {
        app = firebase.initializeApp(firebaseConfig);
        db = firebase.firestore();
        console.log("Firebase –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω");
    } catch (error) {
        console.error("–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Firebase:", error);
    }
    
    // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    let currentUser = null;
    let userBalance = 0;
    let userTransactions = [];
    const STAR_RATE = 1.1; // 1 Star = 1.1 RUB
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    async function initUserFirebase() {
        try {
            const tgUser = tg.initDataUnsafe?.user;
            if (!tgUser) {
                showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram', 'error');
                return;
            }
            
            const userId = `tg_${tgUser.id}`;
            currentUser = {
                id: userId,
                name: tgUser.first_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
                telegramId: tgUser.id,
                username: tgUser.username || null
            };
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            let userData = null;
            if (db) {
                const userDoc = await db.collection('users').doc(userId).get();
                if (userDoc.exists) {
                    userData = userDoc.data();
                }
            }
            
            // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–æ–≤—ã–π
            if (!userData) {
                userBalance = 0;
                userTransactions = [];
                
                userData = {
                    ...currentUser,
                    balance: userBalance,
                    transactions: userTransactions,
                    registrationDate: new Date().toISOString()
                };
                
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                await saveUserToFirestore(userId, userData);
            } else {
                // –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
                userBalance = userData.balance || 0;
                userTransactions = userData.transactions || [];
            }
            
            updateBalance();
            updateHistory();
            
        } catch (error) {
            console.error("–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:", error);
        }
    }
    
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    async function saveUserToFirestore(userId, userData) {
        try {
            if (!db) {
                saveToLocalStorage(userId, userData);
                return;
            }
            
            userData.updated = firebase.firestore.FieldValue.serverTimestamp();
            userData.lastUpdate = new Date().toISOString();
            
            await db.collection('users').doc(userId).set(userData, { merge: true });
            saveToLocalStorage(userId, userData);
            
        } catch (error) {
            console.error("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:", error);
            saveToLocalStorage(userId, userData);
        }
    }
    
    // LocalStorage (—Ä–µ–∑–µ—Ä–≤)
    function saveToLocalStorage(userId, data) {
        try {
            localStorage.setItem(`user_${userId}`, JSON.stringify(data));
        } catch (e) {
            console.error("–û—à–∏–±–∫–∞ localStorage:", e);
        }
    }
    
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
    async function addTransaction(transaction) {
        if (!currentUser) return;
        
        try {
            const userId = currentUser.id;
            let userData = null;
            
            if (db) {
                const userDoc = await db.collection('users').doc(userId).get();
                if (userDoc.exists) {
                    userData = userDoc.data();
                }
            }
            
            if (!userData) {
                userData = loadFromLocalStorage(userId);
            }
            
            if (!userData) {
                userData = {
                    ...currentUser,
                    balance: userBalance,
                    transactions: [],
                    registrationDate: new Date().toISOString()
                };
            }
            
            // –°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
            transaction.id = 'tx_' + Date.now();
            transaction.timestamp = new Date().toISOString();
            transaction.date = new Date().toLocaleDateString('ru-RU');
            transaction.time = new Date().toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
            if (transaction.amount) {
                userBalance += transaction.amount;
                userData.balance = userBalance;
            }
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é
            userData.transactions = userData.transactions || [];
            userData.transactions.push(transaction);
            userTransactions = userData.transactions;
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
            await saveUserToFirestore(userId, userData);
            
            updateBalance();
            updateHistory();
            
        } catch (error) {
            console.error("–û—à–∏–±–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:", error);
        }
    }
    
    // –ü–æ–∫—É–ø–∫–∞ Stars
    async function buyStars(starsAmount) {
        try {
            const cost = starsAmount * STAR_RATE;
            const commission = cost * 0.015;
            const total = cost + commission;
            
            if (total > userBalance) {
                throw new Error('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –±–∞–ª–∞–Ω—Å–µ');
            }
            
            // –°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ–∫—É–ø–∫–∏
            await addTransaction({
                type: 'stars_purchase',
                amount: -total,
                stars: starsAmount,
                cost: cost,
                commission: commission,
                status: 'completed',
                description: `–ü–æ–∫—É–ø–∫–∞ ${starsAmount} Telegram Stars`
            });
            
            return {
                success: true,
                stars: starsAmount,
                cost: cost,
                commission: commission,
                total: total
            };
            
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏:', error);
            return {
                success: false,
                error: error.message
            };
        }
    }
    
    // –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
    function initTheme() {
        if (tg.colorScheme === 'dark') {
            document.body.classList.add('theme-dark');
        } else {
            document.body.classList.remove('theme-dark');
        }
        
        tg.onEvent('themeChanged', () => {
            if (tg.colorScheme === 'dark') {
                document.body.classList.add('theme-dark');
            } else {
                document.body.classList.remove('theme-dark');
            }
        });
    }
    
    function updateBalance() {
        const balanceElement = document.getElementById('balance');
        if (balanceElement) {
            balanceElement.textContent = userBalance.toFixed(2).replace('.', ',') + ' ‚ÇΩ';
        }
    }
    
    function showNotification(title, message, type = 'info') {
        const notification = document.getElementById('notification');
        const titleElement = document.getElementById('notification-title');
        const textElement = document.getElementById('notification-text');
        const iconElement = document.getElementById('notification-icon');
        
        titleElement.textContent = title;
        textElement.textContent = message;
        
        switch(type) {
            case 'success':
                iconElement.textContent = '‚úÖ';
                break;
            case 'error':
                iconElement.textContent = '‚ùå';
                break;
            case 'warning':
                iconElement.textContent = '‚ö†Ô∏è';
                break;
            case 'info':
                iconElement.textContent = 'üí´';
                break;
            default:
                iconElement.textContent = 'üí´';
        }
        
        notification.classList.add('show');
        
        setTimeout(() => {
            notification.classList.remove('show');
        }, 3000);
    }
    
    function showTab(tabName) {
        document.querySelectorAll('.section.fade-in').forEach(section => {
            section.classList.add('hidden');
        });
        
        document.querySelectorAll('.tab').forEach(tab => {
            tab.classList.remove('active');
        });
        
        const targetTab = document.getElementById(`${tabName}-tab`);
        if (targetTab) {
            targetTab.classList.remove('hidden');
            targetTab.style.animation = 'none';
            setTimeout(() => {
                targetTab.style.animation = '';
            }, 10);
        }
        
        const tabButtons = document.querySelectorAll('.tab');
        const tabNames = ['buy', 'history', 'about'];
        const index = tabNames.indexOf(tabName);
        if (index !== -1 && tabButtons[index]) {
            tabButtons[index].classList.add('active');
        }
        
        if (tabName === 'history') {
            updateHistory();
        }
    }
    
    function openModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
            modal.classList.add('show');
            document.body.style.overflow = 'hidden';
        }
    }
    
    function closeModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
            modal.classList.remove('show');
            document.body.style.overflow = 'auto';
        }
    }
    
    // –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ Stars
    function updateStarsCost() {
        const starsInput = document.getElementById('stars-amount');
        const stars = parseInt(starsInput.value) || 0;
        
        if (stars < 10) {
            starsInput.value = 10;
            return updateStarsCost();
        }
        
        if (stars > 100000) {
            starsInput.value = 100000;
            return updateStarsCost();
        }
        
        const cost = stars * STAR_RATE;
        const commission = cost * 0.015;
        const total = cost + commission;
        
        document.getElementById('stars-cost').textContent = cost.toFixed(2).replace('.', ',') + ' ‚ÇΩ';
        document.getElementById('commission').textContent = commission.toFixed(2).replace('.', ',') + ' ‚ÇΩ';
        document.getElementById('total-cost').textContent = total.toFixed(2).replace('.', ',') + ' ‚ÇΩ';
    }
    
    // –ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä —Å—É–º–º—ã
    function setStarsAmount(amount) {
        document.getElementById('stars-amount').value = amount;
        updateStarsCost();
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫
        document.querySelectorAll('.calc-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        event.target.classList.add('active');
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏
    function updateHistory() {
        const historyList = document.getElementById('history-list');
        if (!historyList) return;
        
        historyList.innerHTML = '';
        
        const sortedTransactions = [...userTransactions].sort((a, b) => {
            return new Date(b.timestamp) - new Date(a.timestamp);
        });
        
        if (sortedTransactions.length === 0) {
            historyList.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-star"></i>
                    <p>–ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫ –ø—É—Å—Ç–∞</p>
                    <p class="text-muted mt-2">–ö—É–ø–∏—Ç–µ —Å–≤–æ–∏ –ø–µ—Ä–≤—ã–µ Telegram Stars</p>
                </div>
            `;
            return;
        }
        
        sortedTransactions.forEach(transaction => {
            const item = document.createElement('div');
            item.className = 'history-item';
            
            if (transaction.type === 'stars_purchase') {
                item.innerHTML = `
                    <div class="history-info">
                        <div class="history-title">–ü–æ–∫—É–ø–∫–∞ Telegram Stars</div>
                        <div class="history-subtitle">${transaction.date} ${transaction.time}</div>
                        <div class="history-status status-success">–£—Å–ø–µ—à–Ω–æ</div>
                    </div>
                    <div>
                        <div style="font-size: 14px; color: var(--tg-secondary-text-color); text-align: right; margin-bottom: 4px;">
                            ${transaction.stars} ‚òÖ
                        </div>
                        <div class="history-amount negative">
                            -${transaction.total?.toFixed(2) || '0.00'} ‚ÇΩ
                        </div>
                    </div>
                `;
            } else if (transaction.type === 'bonus') {
                item.innerHTML = `
                    <div class="history-info">
                        <div class="history-title">${transaction.description}</div>
                        <div class="history-subtitle">${transaction.date} ${transaction.time}</div>
                        <div class="history-status status-success">–ë–æ–Ω—É—Å</div>
                    </div>
                    <div class="history-amount positive">
                        +${transaction.amount?.toFixed(2) || '0.00'} ‚ÇΩ
                    </div>
                `;
            }
            
            historyList.appendChild(item);
        });
    }
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
    document.addEventListener('DOMContentLoaded', async function() {
        try {
            tg.expand();
            tg.enableClosingConfirmation();
            initTheme();
            
            await initUserFirebase();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ Stars
            document.getElementById('stars-amount').addEventListener('input', updateStarsCost);
            updateStarsCost(); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            
        } catch (error) {
            console.error("–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:", error);
            showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ', 'error');
        }
    });
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã –ø–æ–∫—É–ø–∫–∏
    document.getElementById('buy-form')?.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        if (!currentUser) {
            showNotification('–û—à–∏–±–∫–∞', '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω', 'error');
            return;
        }
        
        const starsInput = document.getElementById('stars-amount');
        const stars = parseInt(starsInput.value);
        
        if (stars < 10 || stars > 100000) {
            showNotification('–û—à–∏–±–∫–∞', '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ Stars –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç 10 –¥–æ 100,000', 'error');
            return;
        }
        
        try {
            const result = await buyStars(stars);
            
            if (result.success) {
                // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                document.getElementById('purchased-stars').textContent = stars;
                document.getElementById('buy-result').classList.remove('hidden');
                document.getElementById('buy-form').style.display = 'none';
                
                showNotification('–£—Å–ø–µ—à–Ω–æ!', `–ö—É–ø–ª–µ–Ω–æ ${stars} Telegram Stars`, 'success');
            } else {
                showNotification('–û—à–∏–±–∫–∞', result.error, 'error');
            }
            
        } catch (error) {
            showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø–æ–∫—É–ø–∫—É', 'error');
        }
    });
    
    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
    function loadFromLocalStorage(userId) {
        try {
            const data = localStorage.getItem(`user_${userId}`);
            return data ? JSON.parse(data) : null;
        } catch (e) {
            console.error("–û—à–∏–±–∫–∞ localStorage:", e);
            return null;
        }
    }
    
    // –í–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ –∫–ª–∏–∫–∞—Ö
    if (navigator.vibrate) {
        document.querySelectorAll('button, .tab, .calc-btn, .footer-link').forEach(element => {
            element.addEventListener('click', function() {
                navigator.vibrate(30);
            });
        });
    }
    </script>
</body>
</html>