<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CashCheck ‚Äî –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è –¥–µ–Ω–µ–∂–Ω—ã—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Roboto+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
    <style>
        /* CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ç–µ–º–Ω–æ–π/—Å–≤–µ—Ç–ª–æ–π —Ç–µ–º—ã */
        :root {
            /* –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
            --tg-bg-color: #FFFFFF;
            --tg-secondary-bg-color: #F8FAFC;
            --tg-text-color: #1E293B;
            --tg-secondary-text-color: #475569;
            --tg-hint-color: #94A3B8;
            --tg-link-color: #2D5BFF;
            --tg-button-color: #2D5BFF;
            --tg-button-text-color: #FFFFFF;
            --tg-border-color: #E2E8F0;
            --tg-card-bg: #FFFFFF;
            --tg-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            --tg-input-bg: #FFFFFF;
            
            /* –ë—Ä–µ–Ω–¥–æ–≤—ã–µ —Ü–≤–µ—Ç–∞ (–Ω–µ –º–µ–Ω—è—é—Ç—Å—è) */
            --primary-blue: #2D5BFF;
            --primary-purple: #7B61FF;
            --success-color: #10B981;
            --error-color: #EF4444;
            --warning-color: #F59E0B;
            --info-color: #3B82F6;
            --radius-lg: 20px;
            --radius-md: 16px;
            --radius-sm: 12px;
        }
        
        /* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ */
        .theme-dark {
            --tg-bg-color: #0F172A;
            --tg-secondary-bg-color: #1E293B;
            --tg-text-color: #F1F5F9;
            --tg-secondary-text-color: #CBD5E1;
            --tg-hint-color: #64748B;
            --tg-link-color: #60A5FA;
            --tg-button-color: #3B82F6;
            --tg-button-text-color: #FFFFFF;
            --tg-border-color: #334155;
            --tg-card-bg: #1E293B;
            --tg-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            --tg-input-bg: #334155;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--tg-bg-color);
            color: var(--tg-text-color);
            line-height: 1.6;
            min-height: 100vh;
            transition: background-color 0.3s ease, color 0.3s ease;
            padding-bottom: 80px;
        }
        
        .container {
            max-width: 100%;
            padding: 16px;
            margin: 0 auto;
        }
        
        /* –®–∞–ø–∫–∞ */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 0;
            margin-bottom: 16px;
            border-bottom: 1px solid var(--tg-border-color);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 22px;
            font-weight: 800;
            color: var(--tg-text-color);
            text-decoration: none;
        }
        
        .logo-icon {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-purple) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .balance {
            background: var(--tg-card-bg);
            border: 1px solid var(--tg-border-color);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            font-weight: 700;
            font-size: 20px;
            color: var(--tg-text-color);
            box-shadow: var(--tg-shadow);
        }
        
        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */
        .main-content {
            padding-bottom: 20px;
        }
        
        .section {
            background: var(--tg-card-bg);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 16px;
            border: 1px solid var(--tg-border-color);
            box-shadow: var(--tg-shadow);
        }
        
        .section-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--tg-text-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            color: var(--tg-link-color);
            font-size: 22px;
        }
        
        /* –¢–∞–±—ã */
        .tabs {
            display: flex;
            gap: 8px;
            background: var(--tg-secondary-bg-color);
            padding: 6px;
            border-radius: var(--radius-md);
            margin-bottom: 20px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .tab {
            flex: 0 0 auto;
            padding: 12px 16px;
            border: none;
            background: transparent;
            font-family: 'Inter', sans-serif;
            font-weight: 600;
            font-size: 14px;
            color: var(--tg-secondary-text-color);
            border-radius: var(--radius-sm);
            cursor: pointer;
            text-align: center;
            white-space: nowrap;
            transition: all 0.2s ease;
        }
        
        .tab.active {
            background: var(--tg-card-bg);
            color: var(--tg-link-color);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        /* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –º–µ—Ç–æ–¥–æ–≤ –≤—ã–≤–æ–¥–∞ */
        .method-switcher {
            display: flex;
            gap: 8px;
            background: var(--tg-secondary-bg-color);
            padding: 6px;
            border-radius: var(--radius-md);
            margin-bottom: 20px;
        }
        
        .method-switch {
            flex: 1;
            padding: 14px 16px;
            border: none;
            background: transparent;
            font-family: 'Inter', sans-serif;
            font-weight: 600;
            font-size: 15px;
            color: var(--tg-secondary-text-color);
            border-radius: var(--radius-sm);
            cursor: pointer;
            text-align: center;
            transition: all 0.2s ease;
        }
        
        .method-switch.active {
            background: var(--tg-card-bg);
            color: var(--tg-link-color);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        /* –§–æ—Ä–º—ã */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 15px;
            color: var(--tg-text-color);
        }
        
        .form-input {
            width: 100%;
            padding: 16px;
            background: var(--tg-input-bg);
            border: 2px solid var(--tg-border-color);
            border-radius: var(--radius-md);
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            color: var(--tg-text-color);
            transition: all 0.2s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--tg-link-color);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }
        
        .form-hint {
            display: block;
            margin-top: 6px;
            font-size: 13px;
            color: var(--tg-hint-color);
        }
        
        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-purple) 100%);
            color: white;
            border: none;
            border-radius: var(--radius-md);
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(45, 91, 255, 0.25);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-secondary {
            background: var(--tg-secondary-bg-color);
            color: var(--tg-text-color);
            border: 1px solid var(--tg-border-color);
        }
        
        /* –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π */
        .history-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .history-item {
            background: var(--tg-card-bg);
            border: 1px solid var(--tg-border-color);
            border-radius: var(--radius-md);
            padding: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: transform 0.2s ease;
        }
        
        .history-item:hover {
            transform: translateY(-2px);
        }
        
        .history-info {
            flex: 1;
        }
        
        .history-title {
            font-weight: 600;
            font-size: 16px;
            color: var(--tg-text-color);
            margin-bottom: 4px;
        }
        
        .history-subtitle {
            font-size: 14px;
            color: var(--tg-secondary-text-color);
        }
        
        .history-amount {
            font-weight: 700;
            font-size: 18px;
        }
        
        .history-amount.positive {
            color: var(--success-color);
        }
        
        .history-amount.negative {
            color: var(--error-color);
        }
        
        .history-status {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 20px;
            margin-top: 4px;
            display: inline-block;
        }
        
        .status-success {
            background: rgba(16, 185, 129, 0.15);
            color: var(--success-color);
        }
        
        .status-pending {
            background: rgba(245, 158, 11, 0.15);
            color: var(--warning-color);
        }
        
        .status-error {
            background: rgba(239, 68, 68, 0.15);
            color: var(--error-color);
        }
        
        /* –ë–∞–Ω–∫–∏ */
        .bank-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-top: 12px;
        }
        
        .bank-option {
            background: var(--tg-card-bg);
            border: 2px solid var(--tg-border-color);
            border-radius: var(--radius-md);
            padding: 16px 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .bank-option.active {
            border-color: var(--tg-link-color);
            background: rgba(59, 130, 246, 0.05);
        }
        
        .bank-logo {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 16px;
            color: white;
        }
        
        .bank-name {
            font-size: 12px;
            font-weight: 600;
            color: var(--tg-text-color);
            text-align: center;
        }
        
        /* –ù–æ–≤–æ—Å—Ç–∏ */
        .news-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        
        .news-item {
            background: var(--tg-card-bg);
            border: 1px solid var(--tg-border-color);
            border-radius: var(--radius-md);
            padding: 20px;
            transition: transform 0.2s ease;
        }
        
        .news-item:hover {
            transform: translateY(-2px);
        }
        
        .news-date {
            display: inline-block;
            padding: 6px 12px;
            background: rgba(59, 130, 246, 0.1);
            color: var(--tg-link-color);
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 12px;
        }
        
        .news-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 12px;
            color: var(--tg-text-color);
        }
        
        .news-content {
            font-size: 15px;
            color: var(--tg-secondary-text-color);
            line-height: 1.6;
        }
        
        .news-highlight {
            border-left: 4px solid var(--success-color);
            background: rgba(16, 185, 129, 0.05);
        }
        
        .news-warning {
            border-left: 4px solid var(--warning-color);
            background: rgba(245, 158, 11, 0.05);
        }
        
        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(-100%);
            background: var(--tg-card-bg);
            border: 1px solid var(--tg-border-color);
            border-radius: var(--radius-md);
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            max-width: 90%;
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(-50%) translateY(0);
        }
        
        .notification-icon {
            font-size: 24px;
        }
        
        .notification-content {
            flex: 1;
        }
        
        .notification-title {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 4px;
        }
        
        .notification-text {
            font-size: 14px;
            color: var(--tg-secondary-text-color);
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        
        .modal.show {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: var(--tg-card-bg);
            border-radius: var(--radius-lg);
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }
        
        .modal.show .modal-content {
            transform: translateY(0);
        }
        
        .modal-header {
            padding: 20px;
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-purple) 100%);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 20px;
            font-weight: 700;
        }
        
        .modal-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 10px;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-body {
            padding: 20px;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        .document-content {
            color: var(--tg-text-color);
            line-height: 1.6;
        }
        
        .document-content h3 {
            margin: 20px 0 12px;
            font-size: 18px;
            font-weight: 700;
        }
        
        .document-content p {
            margin-bottom: 16px;
            font-size: 15px;
        }
        
        .document-content ul {
            margin: 12px 0 16px 20px;
        }
        
        .document-content li {
            margin-bottom: 8px;
            font-size: 15px;
        }
        
        /* –§—É—Ç–µ—Ä */
        .footer {
            margin-top: 32px;
            padding-top: 20px;
            border-top: 1px solid var(--tg-border-color);
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .footer-link {
            color: var(--tg-link-color);
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
        }
        
        .footer-text {
            text-align: center;
            margin-top: 16px;
            font-size: 13px;
            color: var(--tg-hint-color);
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π */
        .warning-box {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid var(--warning-color);
            border-radius: var(--radius-md);
            padding: 16px;
            margin-bottom: 20px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        
        .warning-box i {
            color: var(--warning-color);
            font-size: 20px;
            margin-top: 2px;
        }
        
        .warning-content h4 {
            color: var(--warning-color);
            font-weight: 700;
            margin-bottom: 6px;
            font-size: 16px;
        }
        
        .warning-content p {
            color: var(--tg-text-color);
            font-size: 14px;
            line-height: 1.5;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ */
        .info-box {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid var(--info-color);
            border-radius: var(--radius-md);
            padding: 16px;
            margin-bottom: 20px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        
        .info-box i {
            color: var(--info-color);
            font-size: 20px;
            margin-top: 2px;
        }
        
        .info-content h4 {
            color: var(--info-color);
            font-weight: 700;
            margin-bottom: 6px;
            font-size: 16px;
        }
        
        .info-content p {
            color: var(--tg-text-color);
            font-size: 14px;
            line-height: 1.5;
        }
        
        /* –ú–µ—Ç–æ–¥—ã –æ–ø–ª–∞—Ç—ã */
        .payment-methods {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .payment-method {
            background: var(--tg-card-bg);
            border: 2px solid var(--tg-border-color);
            border-radius: var(--radius-md);
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .payment-method.active {
            border-color: var(--tg-link-color);
            background: rgba(59, 130, 246, 0.05);
        }
        
        .payment-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
        }
        
        .payment-icon.card {
            background: linear-gradient(135deg, #6366F1 0%, #8B5CF6 100%);
        }
        
        .payment-icon.yoomoney {
            background: linear-gradient(135deg, #2D5BFF 0%, #7B61FF 100%);
        }
        
        .payment-info {
            flex: 1;
        }
        
        .payment-name {
            font-weight: 700;
            font-size: 16px;
            color: var(--tg-text-color);
            margin-bottom: 4px;
        }
        
        .payment-description {
            font-size: 14px;
            color: var(--tg-secondary-text-color);
        }
        
        /* –ë–ª–æ–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –≤—ã–≤–æ–¥–∞ */
        .withdraw-method-block {
            display: none;
        }
        
        .withdraw-method-block.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 480px) {
            .container {
                padding: 12px;
            }
            
            .section {
                padding: 16px;
            }
            
            .tab {
                padding: 10px 12px;
                font-size: 13px;
            }
            
            .bank-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .modal-body {
                padding: 16px;
            }
            
            .method-switch {
                padding: 12px 14px;
                font-size: 14px;
            }
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease forwards;
        }
        
        /* –°–∫—Ä—ã—Ç—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã */
        .hidden {
            display: none !important;
        }
        
        /* –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è —Ç–µ–∫—Å—Ç–∞ */
        .text-muted {
            color: var(--tg-secondary-text-color) !important;
        }
        
        .text-center {
            text-align: center;
        }
        
        /* –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –ø—É—Å—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–∏ */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
        }
        
        .empty-state i {
            font-size: 48px;
            color: var(--tg-hint-color);
            margin-bottom: 16px;
            opacity: 0.5;
        }
        
        .empty-state p {
            color: var(--tg-secondary-text-color);
            font-size: 16px;
        }
        
        /* –£—Ç–∏–ª–∏—Ç—ã –æ—Ç—Å—Ç—É–ø–æ–≤ */
        .mt-2 { margin-top: 8px; }
        .mt-3 { margin-top: 12px; }
        .mt-4 { margin-top: 16px; }
        .mb-2 { margin-bottom: 8px; }
        .mb-3 { margin-bottom: 12px; }
        .mb-4 { margin-bottom: 16px; }
    </style>
</head>
<body>
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ -->
    <div id="agreementModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">–î–æ–∫—É–º–µ–Ω—Ç—ã</div>
                <button class="modal-close" onclick="closeModal('agreementModal')">√ó</button>
            </div>
            <div class="modal-body">
                <div id="agreement-content" class="document-content">
                    <h3>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ</h3>
                    <p><strong>–î–∞—Ç–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ —Å–∏–ª—É:</strong> 1 —è–Ω–≤–∞—Ä—è 2026 –≥–æ–¥–∞</p>
                    
                    <h4>1. –û–±—â–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è</h4>
                    <p>1.1. –ù–∞—Å—Ç–æ—è—â–µ–µ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ —Ä–µ–≥—É–ª–∏—Ä—É–µ—Ç –æ—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–æ–º CashCheck –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –°–µ—Ä–≤–∏—Å–∞.</p>
                    <p>1.2. –ò—Å–ø–æ–ª—å–∑—É—è –°–µ—Ä–≤–∏—Å, –≤—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç–µ —Å–≤–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ —Å —É—Å–ª–æ–≤–∏—è–º–∏ –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ –°–æ–≥–ª–∞—à–µ–Ω–∏—è.</p>
                    
                    <h4>2. –û–ø–∏—Å–∞–Ω–∏–µ –°–µ—Ä–≤–∏—Å–∞</h4>
                    <p>CashCheck - —ç—Ç–æ –æ–Ω–ª–∞–π–Ω-—Å–µ—Ä–≤–∏—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –æ–±–Ω–∞–ª–∏—á–∏–≤–∞–Ω–∏—è –¥–µ–Ω–µ–∂–Ω—ã—Ö —á–µ–∫–æ–≤, –∞ —Ç–∞–∫–∂–µ –¥–ª—è –æ—Å—É—â–µ—Å—Ç–≤–ª–µ–Ω–∏—è –¥–µ–Ω–µ–∂–Ω—ã—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.</p>
                    
                    <h4>3. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ —É—á–µ—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å</h4>
                    <p>3.1. –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –°–µ—Ä–≤–∏—Å–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è.</p>
                    <p>3.2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–±—è–∑—É–µ—Ç—Å—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å —Ç–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º.</p>
                    
                    <h4>4. –ü—Ä–∞–≤–∏–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</h4>
                    <p>4.1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–≥–ª–∞—à–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –°–µ—Ä–≤–∏—Å —Ç–æ–ª—å–∫–æ –≤ –∑–∞–∫–æ–Ω–Ω—ã—Ö —Ü–µ–ª—è—Ö.</p>
                    <p>4.2. –ó–∞–ø—Ä–µ—â–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –°–µ—Ä–≤–∏—Å –¥–ª—è –Ω–µ–∑–∞–∫–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.</p>
                    
                    <h4>5. –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</h4>
                    <p>5.1. –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ—Å—É—â–µ—Å—Ç–≤–ª—è—é—Ç—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ–º.</p>
                    <p>5.2. –ö–æ–º–∏—Å—Å–∏—è –∑–∞ –≤—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤: 1.5% –æ—Ç —Å—É–º–º—ã.</p>
                    <p>5.3. –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ —á–µ–∫–∞: 10 ‚ÇΩ, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è: 100 000 ‚ÇΩ.</p>
                    <p>5.4. –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –≤—ã–≤–æ–¥–∞: 100 ‚ÇΩ.</p>
                    <p>5.5. –°—Ä–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞—è–≤–æ–∫: 1-7 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π.</p>
                    
                    <h4>6. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å</h4>
                    <p>6.1. –°–µ—Ä–≤–∏—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –∑–∞—â–∏—Ç—ã –¥–∞–Ω–Ω—ã—Ö.</p>
                    <p>6.2. –°–µ—Ä–≤–∏—Å –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º –±–µ–∑ —Å–æ–≥–ª–∞—Å–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.</p>
                    
                    <h4>7. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏</h4>
                    <p>7.1. –°–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è "–∫–∞–∫ –µ—Å—Ç—å". –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –±–µ—Å–ø–µ—Ä–µ–±–æ–π–Ω—É—é —Ä–∞–±–æ—Ç—É –∏ –Ω–µ –Ω–µ—Å–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ –¥–µ–Ω–µ–∂–Ω—ã–π —É—â–µ—Ä–± –≤–æ –≤—Ä–µ–º—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞.</p>
                    
                    <h4>8. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –°–æ–≥–ª–∞—à–µ–Ω–∏–∏</h4>
                    <p>8.1. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è –æ—Å—Ç–∞–≤–ª—è–µ—Ç –∑–∞ —Å–æ–±–æ–π –ø—Ä–∞–≤–æ –≤–Ω–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –°–æ–≥–ª–∞—à–µ–Ω–∏–µ.</p>
                    
                    <h4>9. –ö–æ–Ω—Ç–∞–∫—Ç—ã</h4>
                    <p>–ü–æ –≤—Å–µ–º –≤–æ–ø—Ä–æ—Å–∞–º –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å: cashcheckru@mail.ru</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="notification" class="notification">
        <div class="notification-icon" id="notification-icon">üí∏</div>
        <div class="notification-content">
            <div class="notification-title" id="notification-title">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</div>
            <p class="notification-text" id="notification-text">–¢–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</p>
        </div>
    </div>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
    <div class="container">
        <!-- –®–∞–ø–∫–∞ -->
        <div class="header">
            <div class="logo">
                <div class="logo-icon">C$</div>
                <span>CashCheck</span>
            </div>
            <div class="user-info">
                <div class="balance" id="balance">0 ‚ÇΩ</div>
            </div>
        </div>
        
        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="main-content">
            <!-- –¢–∞–±—ã –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
            <div class="tabs">
                <button class="tab active" onclick="showTab('checkout')">–û–±–Ω–∞–ª–∏—á–∏—Ç—å</button>
                <button class="tab" onclick="showTab('create')">–°–æ–∑–¥–∞—Ç—å</button>
                <button class="tab" onclick="showTab('topup')">–ü–æ–ø–æ–ª–Ω–∏—Ç—å</button>
                <button class="tab" onclick="showTab('withdraw')">–í—ã–≤–æ–¥</button>
                <button class="tab" onclick="showTab('history')">–ò—Å—Ç–æ—Ä–∏—è</button>
                <button class="tab" onclick="showTab('news')">–ù–æ–≤–æ—Å—Ç–∏</button>
            </div>
            
            <!-- –û–±–Ω–∞–ª–∏—á–∏–≤–∞–Ω–∏–µ —á–µ–∫–∞ -->
            <div id="checkout-tab" class="section fade-in">
                <div class="section-title">
                    <i class="fas fa-money-check-alt"></i>
                    <span>–û–±–Ω–∞–ª–∏—á–∏—Ç—å —á–µ–∫</span>
                </div>
                
                <form id="checkout-form">
                    <div class="form-group">
                        <label class="form-label">–ö–æ–¥ —á–µ–∫–∞</label>
                        <input type="text" class="form-input" id="check-code" placeholder="–í–≤–µ–¥–∏—Ç–µ 10-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥" maxlength="10" required>
                        <span class="form-hint">–ü—Ä–∏–º–µ—Ä: X8F7G2H9K5</span>
                    </div>
                    <button type="submit" class="btn">
                        <i class="fas fa-money-bill-wave"></i>
                        –û–±–Ω–∞–ª–∏—á–∏—Ç—å —á–µ–∫
                    </button>
                </form>
            </div>
            
            <!-- –°–æ–∑–¥–∞–Ω–∏–µ —á–µ–∫–∞ -->
            <div id="create-tab" class="section fade-in hidden">
                <div class="section-title">
                    <i class="fas fa-plus-circle"></i>
                    <span>–°–æ–∑–¥–∞—Ç—å —á–µ–∫</span>
                </div>
                
                <form id="create-form">
                    <div class="form-group">
                        <label class="form-label">–°—É–º–º–∞ —á–µ–∫–∞</label>
                        <input type="number" class="form-input" id="check-amount" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 1000" min="10" max="100000" required>
                        <span class="form-hint">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞: 10 ‚ÇΩ, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è: 100 000 ‚ÇΩ</span>
                    </div>
                    <button type="submit" class="btn">
                        <i class="fas fa-file-invoice-dollar"></i>
                        –°–æ–∑–¥–∞—Ç—å —á–µ–∫
                    </button>
                </form>
                
                <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–∑–¥–∞–Ω–∏—è —á–µ–∫–∞ -->
                <div id="check-result" class="section mt-4 hidden">
                    <div class="section-title">
                        <i class="fas fa-check-circle" style="color: var(--success-color);"></i>
                        <span>–ß–µ–∫ —Å–æ–∑–¥–∞–Ω</span>
                    </div>
                    <div class="text-center">
                        <div style="font-size: 14px; color: var(--tg-secondary-text-color); margin-bottom: 12px;">
                            –ü–µ—Ä–µ–¥–∞–π—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –ø–æ–ª—É—á–∞—Ç–µ–ª—é:
                        </div>
                        <div style="background: var(--tg-secondary-bg-color); padding: 20px; border-radius: var(--radius-md); font-family: 'Roboto Mono', monospace; font-size: 22px; font-weight: 700; letter-spacing: 2px; margin-bottom: 16px;">
                            <span id="new-check-code">A1B2C3D4E5</span>
                        </div>
                        <div style="font-size: 18px; font-weight: 600; margin-bottom: 20px;">
                            –°—É–º–º–∞: <span id="check-amount-display" style="color: var(--tg-link-color);">1000 ‚ÇΩ</span>
                        </div>
                        <button class="btn btn-secondary" onclick="copyCheckCode()">
                            <i class="fas fa-copy"></i>
                            –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ -->
            <div id="topup-tab" class="section fade-in hidden">
                <div class="section-title">
                    <i class="fas fa-wallet"></i>
                    <span>–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞</span>
                </div>
                
                <!-- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è—Ö -->
                <div class="warning-box">
                    <i class="fas fa-exclamation-triangle"></i>
                    <div class="warning-content">
                        <h4>–í–Ω–∏–º–∞–Ω–∏–µ! –í—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è</h4>
                        <p>–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ —á–µ—Ä–µ–∑ –±–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã –∏ –ÆMoney –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.</p>
                    </div>
                </div>
                
                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ –ø–æ–¥–¥–µ—Ä–∂–∫—É -->
                <div class="info-box">
                    <i class="fas fa-info-circle"></i>
                    <div class="info-content">
                        <h4>–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –ø–æ–¥–¥–µ—Ä–∂–∫—É</h4>
                        <p>–í—ã –º–æ–∂–µ—Ç–µ –ø–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å, —Å–≤—è–∑–∞–≤—à–∏—Å—å —Å –Ω–∞—à–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø–æ –∞–¥—Ä–µ—Å—É: cashcheckru@mail.ru</p>
                    </div>
                </div>
                
                <!-- –í—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞ –æ–ø–ª–∞—Ç—ã -->
                <div class="form-group">
                    <label class="form-label">–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</label>
                    <div class="payment-methods">
                        <div class="payment-method" onclick="selectPaymentMethod('card')">
                            <div class="payment-icon card">
                                <i class="fas fa-credit-card"></i>
                            </div>
                            <div class="payment-info">
                                <div class="payment-name">–ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞</div>
                                <div class="payment-description">Visa, Mastercard, –ú–ò–†</div>
                            </div>
                        </div>
                        
                        <div class="payment-method" onclick="selectPaymentMethod('yoomoney')">
                            <div class="payment-icon yoomoney">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                            <div class="payment-info">
                                <div class="payment-name">–ÆMoney</div>
                                <div class="payment-description">–ö–æ—à–µ–ª–µ–∫ –ÆMoney</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- –§–æ—Ä–º–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è -->
                <form id="topup-form">
                    <div class="form-group">
                        <label class="form-label">–°—É–º–º–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è</label>
                        <input type="number" class="form-input" id="topup-amount" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 5000" min="10" max="100000" disabled>
                        <span class="form-hint">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞: 10 ‚ÇΩ, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è: 100 000 ‚ÇΩ</span>
                    </div>
                    
                    <button type="submit" class="btn" disabled>
                        <i class="fas fa-credit-card"></i>
                        –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ
                    </button>
                </form>
            </div>
            
            <!-- –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤ -->
            <div id="withdraw-tab" class="section fade-in hidden">
                <div class="section-title">
                    <i class="fas fa-money-bill-transfer"></i>
                    <span>–í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</span>
                </div>
                
                <!-- –ö–æ–º–∏—Å—Å–∏—è -->
                <div style="background: rgba(245, 158, 11, 0.1); border-left: 4px solid var(--warning-color); padding: 12px; border-radius: var(--radius-sm); margin-bottom: 20px;">
                    <div style="font-weight: 600; color: var(--warning-color);">–ö–æ–º–∏—Å—Å–∏—è –∑–∞ –≤—ã–≤–æ–¥: 1.5%</div>
                    <div style="font-size: 14px; color: var(--tg-secondary-text-color); margin-top: 4px;">
                        <div>–°—Ä–æ–∫ –∑–∞—á–∏—Å–ª–µ–Ω–∏—è:</div>
                        <div>‚Ä¢ –ù–∞ –∫–∞—Ä—Ç—É: 1-7 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π</div>
                        <div>‚Ä¢ –ù–∞ –ÆMoney: 1-3 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è</div>
                    </div>
                </div>
                
                <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –º–µ—Ç–æ–¥–∞ –≤—ã–≤–æ–¥–∞ -->
                <div class="method-switcher">
                    <button class="method-switch active" onclick="selectWithdrawMethod('card')">–ù–∞ –∫–∞—Ä—Ç—É</button>
                    <button class="method-switch" onclick="selectWithdrawMethod('yoomoney')">–ù–∞ –ÆMoney</button>
                </div>
                
                <!-- –ë–ª–æ–∫ –¥–ª—è –≤—ã–≤–æ–¥–∞ –Ω–∞ –∫–∞—Ä—Ç—É -->
                <div id="card-withdraw-block" class="withdraw-method-block active">
                    <!-- –í—ã–±–æ—Ä –±–∞–Ω–∫–∞ -->
                    <div class="form-group">
                        <label class="form-label">–í—ã–±–µ—Ä–∏—Ç–µ –±–∞–Ω–∫</label>
                        <div class="bank-grid" id="bank-grid">
                            <!-- –ë–∞–Ω–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
                        </div>
                    </div>
                    
                    <!-- –§–æ—Ä–º–∞ –¥–ª—è –∫–∞—Ä—Ç—ã -->
                    <div class="form-group">
                        <label class="form-label">–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã</label>
                        <input type="text" class="form-input" id="card-number" placeholder="0000 0000 0000 0000" maxlength="19" required>
                        <span class="form-hint">–í–≤–µ–¥–∏—Ç–µ 16-19 —Ü–∏—Ñ—Ä –Ω–æ–º–µ—Ä–∞ –∫–∞—Ä—Ç—ã</span>
                    </div>
                </div>
                
                <!-- –ë–ª–æ–∫ –¥–ª—è –≤—ã–≤–æ–¥–∞ –Ω–∞ –ÆMoney -->
                <div id="yoomoney-withdraw-block" class="withdraw-method-block">
                    <div class="form-group">
                        <label class="form-label">–ù–æ–º–µ—Ä –∫–æ—à–µ–ª—å–∫–∞ –ÆMoney</label>
                        <input type="text" class="form-input" id="yoomoney-account" placeholder="4100123456789012" maxlength="20">
                        <span class="form-hint">–í–≤–µ–¥–∏—Ç–µ 13-20 —Ü–∏—Ñ—Ä –Ω–æ–º–µ—Ä–∞ –∫–æ—à–µ–ª—å–∫–∞ –ÆMoney</span>
                    </div>
                </div>
                
                <!-- –§–æ—Ä–º–∞ –≤—ã–≤–æ–¥–∞ -->
                <form id="withdraw-form">
                    <div class="form-group">
                        <label class="form-label">–°—É–º–º–∞ –≤—ã–≤–æ–¥–∞</label>
                        <input type="number" class="form-input" id="withdraw-amount" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 5000" min="100" max="100000" required>
                        <span class="form-hint">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞: 100 ‚ÇΩ</span>
                        <div style="margin-top: 8px; font-size: 14px; color: var(--tg-secondary-text-color);" id="withdraw-info">
                            –ö–æ–º–∏—Å—Å–∏—è: 0 ‚ÇΩ ‚Ä¢ –ö –ø–æ–ª—É—á–µ–Ω–∏—é: 0 ‚ÇΩ
                        </div>
                    </div>
                    
                    <button type="submit" class="btn" id="withdraw-button">
                        <i class="fas fa-wallet"></i>
                        –í—ã–≤–µ—Å—Ç–∏ –Ω–∞ –∫–∞—Ä—Ç—É
                    </button>
                </form>
            </div>
            
            <!-- –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π -->
            <div id="history-tab" class="section fade-in hidden">
                <div class="section-title">
                    <i class="fas fa-history"></i>
                    <span>–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</span>
                </div>
                
                <div id="history-list">
                    <div class="empty-state">
                        <i class="fas fa-file-invoice-dollar"></i>
                        <p>–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π –ø—É—Å—Ç–∞</p>
                        <p class="text-muted mt-2">–°–æ–≤–µ—Ä—à–∏—Ç–µ –ø–µ—Ä–≤—É—é –æ–ø–µ—Ä–∞—Ü–∏—é</p>
                    </div>
                </div>
            </div>
            
            <!-- –ù–æ–≤–æ—Å—Ç–∏ -->
            <div id="news-tab" class="section fade-in hidden">
                <div class="section-title">
                    <i class="fas fa-newspaper"></i>
                    <span>–ù–æ–≤–æ—Å—Ç–∏ CashCheck</span>
                </div>
                
                <div class="news-list" id="news-list">
                    <!-- –ù–æ–≤–æ—Å—Ç–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
                </div>
            </div>
            
            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ -->
            <div class="section">
                <div class="section-title">
                    <i class="fas fa-shield-alt"></i>
                    <span>–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã</span>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                    <div style="text-align: center; padding: 16px; background: var(--tg-secondary-bg-color); border-radius: var(--radius-md);">
                        <i class="fas fa-lock" style="font-size: 24px; color: var(--tg-link-color); margin-bottom: 8px;"></i>
                        <div style="font-weight: 600; font-size: 14px; margin-bottom: 4px;">–ó–∞—â–∏—Ç–∞</div>
                        <div style="font-size: 12px; color: var(--tg-secondary-text-color);">–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</div>
                    </div>
                    
                    <div style="text-align: center; padding: 16px; background: var(--tg-secondary-bg-color); border-radius: var(--radius-md);">
                        <i class="fas fa-bolt" style="font-size: 24px; color: var(--tg-link-color); margin-bottom: 8px;"></i>
                        <div style="font-weight: 600; font-size: 14px; margin-bottom: 4px;">–°–∫–æ—Ä–æ—Å—Ç—å</div>
                        <div style="font-size: 12px; color: var(--tg-secondary-text-color);">–ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã</div>
                    </div>
                    
                    <div style="text-align: center; padding: 16px; background: var(--tg-secondary-bg-color); border-radius: var(--radius-md);">
                        <i class="fas fa-user-secret" style="font-size: 24px; color: var(--tg-link-color); margin-bottom: 8px;"></i>
                        <div style="font-weight: 600; font-size: 14px; margin-bottom: 4px;">–ê–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å</div>
                        <div style="font-size: 12px; color: var(--tg-secondary-text-color);">–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å</div>
                    </div>
                    
                    <div style="text-align: center; padding: 16px; background: var(--tg-secondary-bg-color); border-radius: var(--radius-md);">
                        <i class="fas fa-clock" style="font-size: 24px; color: var(--tg-link-color); margin-bottom: 8px;"></i>
                        <div style="font-weight: 600; font-size: 14px; margin-bottom: 4px;">–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å</div>
                        <div style="font-size: 12px; color: var(--tg-secondary-text-color);">24/7 —Ä–∞–±–æ—Ç–∞</div>
                    </div>
                </div>
            </div>
            
            <!-- –§—É—Ç–µ—Ä -->
            <div class="footer">
                <div class="footer-links">
                    <a href="#" class="footer-link" onclick="openModal('agreementModal'); return false;">–°–æ–≥–ª–∞—à–µ–Ω–∏–µ</a>
                    <a href="#" class="footer-link" onclick="showNotification('–ü–æ–¥–¥–µ—Ä–∂–∫–∞', '–î–ª—è —Å–≤—è–∑–∏: cashcheckru@mail.ru', 'info'); return false;">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</a>
                    <a href="#" class="footer-link" onclick="showTab('news'); return false;">–ù–æ–≤–æ—Å—Ç–∏</a>
                </div>
                <div class="footer-text">
                    ¬© 2025 CashCheck. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.
                </div>
            </div>
        </div>
    </div>

    <script>
    // Telegram WebApp API
    let tg = window.Telegram.WebApp;
    
    // ============ FIREBASE –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ============
    const firebaseConfig = {
        apiKey: "AIzaSyBaxoVYKmWtLgmTcM0AS5acQ1TN8qKyFfA",
        authDomain: "cashcheck-7e5c6.firebaseapp.com",
        projectId: "cashcheck-7e5c6",
        storageBucket: "cashcheck-7e5c6.firebasestorage.app",
        messagingSenderId: "706696825244",
        appId: "1:706696825244:web:e8de79e5cdae5df9606059"
    };
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
    let app, db;
    try {
        app = firebase.initializeApp(firebaseConfig);
        db = firebase.firestore();
        console.log("Firebase –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω");
    } catch (error) {
        console.error("–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Firebase:", error);
    }
    
    // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    let currentUser = null;
    let userBalance = 0;
    let userTransactions = [];
    let selectedBank = null;
    let selectedPaymentMethod = 'card';
    let selectedWithdrawMethod = 'card';
    
    // –°–ø–∏—Å–æ–∫ –±–∞–Ω–∫–æ–≤
    const RUSSIAN_BANKS = [
        { id: 'sber', name: '–°–±–µ—Ä', color: '#21A038' },
        { id: 'vtb', name: '–í–¢–ë', color: '#1946A0' },
        { id: 'tinkoff', name: '–¢–∏–Ω—å–∫–æ—Ñ—Ñ', color: '#FFDD2D', textColor: '#000000' },
        { id: 'alfa', name: '–ê–ª—å—Ñ–∞', color: '#EF3124' },
        { id: 'raiffeisen', name: '–†–∞–π—Ñ—Ñ–∞–π–∑–µ–Ω', color: '#FFCD00', textColor: '#000000' },
        { id: 'gazprom', name: '–ì–∞–∑–ø—Ä–æ–º', color: '#2D5BFF' },
        { id: 'rosbank', name: '–†–æ—Å–±–∞–Ω–∫', color: '#004C97' },
        { id: 'mts', name: '–ú–¢–°', color: '#E30613' },
        { id: 'post', name: '–û–∑–æ–Ω –±–∞–Ω–∫', color: '#004F9F' }
    ];
    
    // –ù–æ–≤–æ—Å—Ç–∏
    const NEWS = [
        {
            id: 1,
            date: '7 —è–Ω–≤–∞—Ä—è 2026',
            title: '–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Firebase!',
            content: '–¢–µ–ø–µ—Ä—å —á–µ–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ Firebase! –í—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —á–µ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å–∏—Å—Ç–µ–º—ã.',
            type: 'info'
        },
        {
            id: 2,
            date: '6 —è–Ω–≤–∞—Ä—è 2026',
            title: '–í–Ω–∏–º–∞–Ω–∏–µ: –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ!',
            content: '–í —Å–≤—è–∑–∏ —Å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ —Ä–∞–±–æ—Ç–∞–º–∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ —á–µ—Ä–µ–∑ –±–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã –∏ –ÆMoney –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ.',
            type: 'warning'
        },
        {
            id: 3,
            date: '31 –¥–µ–∫–∞–±—Ä—è 2025',
            title: '–ù–æ–≤—ã–π –≥–æ–¥ - –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏!',
            content: '–° –Ω–∞—Å—Ç—É–ø–∞—é—â–∏–º –ù–æ–≤—ã–º –≥–æ–¥–æ–º! –í —á–µ—Å—Ç—å –ø—Ä–∞–∑–¥–Ω–∏–∫–∞ –º—ã —Å–¥–µ–ª–∞–ª–∏ –æ—Å–æ–±—ã–π —á–µ–∫ –Ω–∞ 400—Ä —Å –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∞–∫—Ç–∏–≤–∞—Ü–∏–π. –ö–æ–¥ —á–µ–∫–∞: <strong>HAPPY2026</strong>.',
            type: 'highlight'
        }
    ];
    
    // ============ –°–û–•–†–ê–ù–ï–ù–ò–ï –í FIRESTORE ============
    
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage (—Ä–µ–∑–µ—Ä–≤–Ω–æ–µ)
    function saveToLocalStorage(userId, data) {
        try {
            localStorage.setItem(`user_${userId}`, JSON.stringify(data));
        } catch (e) {
            console.error("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ localStorage:", e);
        }
    }
    
    // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ localStorage (—Ä–µ–∑–µ—Ä–≤–Ω–æ–µ)
    function loadFromLocalStorage(userId) {
        try {
            const data = localStorage.getItem(`user_${userId}`);
            return data ? JSON.parse(data) : null;
        } catch (e) {
            console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ localStorage:", e);
            return null;
        }
    }
    
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Firestore
    async function saveUserToFirestore(userId, userData) {
        try {
            if (!db) {
                console.warn("Firestore –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage");
                saveToLocalStorage(userId, userData);
                return;
            }
            
            // –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è Firestore
            const firestoreData = { ...userData };
            
            // –û–±–Ω–æ–≤–ª—è–µ–º timestamp
            firestoreData.updated = firebase.firestore.FieldValue.serverTimestamp();
            firestoreData.lastUpdate = new Date().toISOString();
            
            await db.collection('users').doc(userId).set(firestoreData, { merge: true });
            console.log("–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ Firestore –¥–ª—è:", userId);
            
            // –¢–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–ø–∏—é –≤ localStorage –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
            saveToLocalStorage(userId, userData);
            
        } catch (error) {
            console.error("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ Firestore:", error);
            saveToLocalStorage(userId, userData);
        }
    }
    
    // ============ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø –° FIRESTORE ============
    async function initUserFirebase() {
        try {
            const tgUser = tg.initDataUnsafe?.user;
            if (!tgUser) {
                showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram', 'error');
                return;
            }
            
            const userId = `tg_${tgUser.id}`;
            
            // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            currentUser = {
                id: userId,
                name: tgUser.first_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
                telegramId: tgUser.id,
                username: tgUser.username || null
            };
            
            console.log("–ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:", userId);
            
            // –ü—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ Firestore
            let userData = null;
            try {
                if (db) {
                    const userDoc = await db.collection('users').doc(userId).get();
                    if (userDoc.exists) {
                        userData = userDoc.data();
                        console.log("–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ Firestore");
                    }
                }
            } catch (firestoreError) {
                console.warn("–û—à–∏–±–∫–∞ Firestore, –ø—Ä–æ–±—É–µ–º localStorage:", firestoreError);
            }
            
            // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –≤ Firestore, –ø—Ä–æ–±—É–µ–º localStorage
            if (!userData) {
                userData = loadFromLocalStorage(userId);
                if (userData) {
                    console.log("–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ localStorage");
                }
            }
            
            // –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç –≤–æ–æ–±—â–µ - –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
            if (!userData) {
                console.log("–ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —Å–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å");
                
                // –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è iwnel - –Ω–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å 1500, –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö - 0
                userBalance = (currentUser.username === 'iwnel') ? 1500 : 0;
                userTransactions = [];
                
                userData = {
                    ...currentUser,
                    balance: userBalance,
                    transactions: userTransactions,
                    registrationDate: new Date().toISOString(),
                    lastLogin: new Date().toISOString()
                };
                
                // –ë–æ–Ω—É—Å –¥–ª—è iwnel
                if (currentUser.username === 'iwnel') {
                    userData.lastBonusDate = new Date().toDateString();
                    userData.lastBonusTime = new Date().toISOString();
                    
                    const bonusTransaction = {
                        id: 'bonus_' + Date.now(),
                        type: 'bonus',
                        amount: 1500,
                        description: '–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –±–æ–Ω—É—Å',
                        timestamp: new Date().toISOString(),
                        date: new Date().toLocaleDateString('ru-RU'),
                        time: new Date().toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' })
                    };
                    
                    userTransactions.push(bonusTransaction);
                    userData.transactions = userTransactions;
                    
                    showNotification('–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –±–æ–Ω—É—Å', '–í–∞–º –Ω–∞—á–∏—Å–ª–µ–Ω–æ 1500 ‚ÇΩ', 'success');
                }
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                await saveUserToFirestore(userId, userData);
                
            } else {
                // –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
                userBalance = userData.balance || 0;
                userTransactions = userData.transactions || [];
                
                console.log("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –±–∞–ª–∞–Ω—Å:", userBalance);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤—Ö–æ–¥–∞
                userData.lastLogin = new Date().toISOString();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å –¥–ª—è iwnel
                if (currentUser.username === 'iwnel') {
                    const now = new Date();
                    const today = now.toDateString();
                    const lastBonusDate = userData.lastBonusDate || null;
                    
                    if (!lastBonusDate || lastBonusDate !== today) {
                        userBalance += 1500;
                        userData.balance = userBalance;
                        userData.lastBonusDate = today;
                        userData.lastBonusTime = now.toISOString();
                        
                        const bonusTransaction = {
                            id: 'bonus_' + Date.now(),
                            type: 'bonus',
                            amount: 1500,
                            description: '–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å',
                            timestamp: new Date().toISOString(),
                            date: new Date().toLocaleDateString('ru-RU'),
                            time: new Date().toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' })
                        };
                        
                        userTransactions.push(bonusTransaction);
                        userData.transactions = userTransactions;
                        
                        showNotification('–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å', '–í–∞–º –Ω–∞—á–∏—Å–ª–µ–Ω–æ 1500 ‚ÇΩ', 'success');
                    }
                }
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                await saveUserToFirestore(userId, userData);
            }
            
            updateBalance();
            updateHistory();
            
        } catch (error) {
            console.error("–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:", error);
            showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ', 'error');
        }
    }
    
    // ============ –î–û–ë–ê–í–õ–ï–ù–ò–ï –¢–†–ê–ù–ó–ê–ö–¶–ò–ò –í FIRESTORE ============
    async function addTransactionToFirebase(transaction) {
        if (!currentUser) {
            showNotification('–û—à–∏–±–∫–∞', '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω', 'error');
            return;
        }
        
        try {
            const userId = currentUser.id;
            
            // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            let userData = null;
            if (db) {
                const userDoc = await db.collection('users').doc(userId).get();
                if (userDoc.exists) {
                    userData = userDoc.data();
                }
            }
            
            // –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ Firestore, –ø—Ä–æ–±—É–µ–º localStorage
            if (!userData) {
                userData = loadFromLocalStorage(userId);
            }
            
            // –ï—Å–ª–∏ –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö, —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
            if (!userData) {
                userData = {
                    ...currentUser,
                    balance: userBalance,
                    transactions: [],
                    registrationDate: new Date().toISOString()
                };
            }
            
            // –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
            transaction.id = 'tx_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            transaction.timestamp = new Date().toISOString();
            transaction.date = new Date().toLocaleDateString('ru-RU');
            transaction.time = new Date().toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å
            if (transaction.amount) {
                userBalance += transaction.amount;
                userData.balance = userBalance;
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ –∏—Å—Ç–æ—Ä–∏—é
            userData.transactions = userData.transactions || [];
            userData.transactions.push(transaction);
            userTransactions = userData.transactions;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            await saveUserToFirestore(userId, userData);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            updateBalance();
            updateHistory();
            
            console.log("–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞:", transaction.type);
            
        } catch (error) {
            console.error("–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:", error);
            showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é', 'error');
        }
    }
    
    // ============ –†–ê–ë–û–¢–ê –° –ß–ï–ö–ê–ú–ò –ß–ï–†–ï–ó FIREBASE ============
    // –°–æ–∑–¥–∞–Ω–∏–µ —á–µ–∫–∞
    async function createCheckFirebase(amount) {
        try {
            if (!db) {
                throw new Error("Firebase –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω");
            }
            
            const checkCode = generateCheckCode();
            
            if (amount > userBalance) {
                throw new Error('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –±–∞–ª–∞–Ω—Å–µ');
            }
            
            // –°–æ–∑–¥–∞–µ–º —á–µ–∫ –≤ Firestore
            await db.collection('checks').doc(checkCode).set({
                code: checkCode,
                amount: amount,
                creatorId: currentUser.id,
                creatorName: currentUser.name,
                status: 'active',
                createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                expiresAt: firebase.firestore.Timestamp.fromDate(new Date(Date.now() + 30 * 24 * 60 * 60 * 1000)) // 30 –¥–Ω–µ–π
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é —Å–æ–∑–¥–∞–Ω–∏—è —á–µ–∫–∞
            await addTransactionToFirebase({
                type: 'check_created',
                amount: -amount,
                checkCode: checkCode,
                status: 'active',
                description: `–°–æ–∑–¥–∞–Ω —á–µ–∫ ${checkCode}`
            });
            
            return {
                success: true,
                code: checkCode,
                amount: amount
            };
            
        } catch (error) {
            console.error('Error creating check:', error);
            return {
                success: false,
                error: error.message
            };
        }
    }
    
    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è —á–µ–∫–∞
    async function activateCheckFirebase(checkCode) {
        try {
            if (!db) {
                throw new Error("Firebase –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω");
            }
            
            checkCode = checkCode.toUpperCase().trim();
            const checkRef = db.collection('checks').doc(checkCode);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —á–µ–∫–∞
            const checkDoc = await checkRef.get();
            
            if (!checkDoc.exists) {
                throw new Error('–ß–µ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω');
            }
            
            const checkData = checkDoc.data();
            
            if (checkData.status !== 'active') {
                throw new Error('–ß–µ–∫ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω');
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è
            const expiresAt = checkData.expiresAt?.toDate ? checkData.expiresAt.toDate() : new Date(checkData.expiresAt);
            if (expiresAt < new Date()) {
                throw new Error('–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —á–µ–∫–∞ –∏—Å—Ç–µ–∫');
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Å–≤–æ–π —á–µ–∫
            if (checkData.creatorId === currentUser.id) {
                throw new Error('–í—ã –Ω–µ –º–æ–∂–µ—Ç–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —á–µ–∫');
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —á–µ–∫
            await checkRef.update({
                status: 'used',
                activatorId: currentUser.id,
                activatorName: currentUser.name,
                activatedAt: firebase.firestore.FieldValue.serverTimestamp()
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —á–µ–∫–∞
            await addTransactionToFirebase({
                type: 'check_activated',
                amount: checkData.amount,
                checkCode: checkCode,
                status: 'used',
                description: `–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω —á–µ–∫ ${checkCode}`
            });
            
            return {
                success: true,
                amount: checkData.amount
            };
            
        } catch (error) {
            console.error('Error activating check:', error);
            return {
                success: false,
                error: error.message
            };
        }
    }
    
    // ============ –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò ============
    function initTheme() {
        if (tg.colorScheme === 'dark') {
            document.body.classList.add('theme-dark');
        } else {
            document.body.classList.remove('theme-dark');
        }
        
        tg.onEvent('themeChanged', () => {
            if (tg.colorScheme === 'dark') {
                document.body.classList.add('theme-dark');
            } else {
                document.body.classList.remove('theme-dark');
            }
        });
    }
    
    function updateBalance() {
        const balanceElement = document.getElementById('balance');
        if (balanceElement) {
            balanceElement.textContent = userBalance.toFixed(2).replace('.', ',') + ' ‚ÇΩ';
        }
    }
    
    function showNotification(title, message, type = 'info') {
        const notification = document.getElementById('notification');
        const titleElement = document.getElementById('notification-title');
        const textElement = document.getElementById('notification-text');
        const iconElement = document.getElementById('notification-icon');
        
        titleElement.textContent = title;
        textElement.textContent = message;
        
        switch(type) {
            case 'success':
                iconElement.textContent = '‚úÖ';
                break;
            case 'error':
                iconElement.textContent = '‚ùå';
                break;
            case 'warning':
                iconElement.textContent = '‚ö†Ô∏è';
                break;
            case 'info':
                iconElement.textContent = 'üí∏';
                break;
            default:
                iconElement.textContent = 'üí∏';
        }
        
        notification.classList.add('show');
        
        setTimeout(() => {
            notification.classList.remove('show');
        }, 3000);
    }
    
    function showTab(tabName) {
        document.querySelectorAll('.section.fade-in').forEach(section => {
            section.classList.add('hidden');
        });
        
        document.querySelectorAll('.tab').forEach(tab => {
            tab.classList.remove('active');
        });
        
        const targetTab = document.getElementById(`${tabName}-tab`);
        if (targetTab) {
            targetTab.classList.remove('hidden');
            targetTab.style.animation = 'none';
            setTimeout(() => {
                targetTab.style.animation = '';
            }, 10);
        }
        
        const tabButtons = document.querySelectorAll('.tab');
        const tabNames = ['checkout', 'create', 'topup', 'withdraw', 'history', 'news'];
        const index = tabNames.indexOf(tabName);
        if (index !== -1 && tabButtons[index]) {
            tabButtons[index].classList.add('active');
        }
        
        if (tabName === 'withdraw') {
            updateWithdrawInfo();
        } else if (tabName === 'history') {
            updateHistory();
        }
    }
    
    function initBanks() {
        const bankGrid = document.getElementById('bank-grid');
        if (!bankGrid) return;
        
        bankGrid.innerHTML = '';
        
        RUSSIAN_BANKS.forEach(bank => {
            const bankOption = document.createElement('div');
            bankOption.className = 'bank-option';
            bankOption.dataset.bankId = bank.id;
            bankOption.innerHTML = `
                <div class="bank-logo" style="background: ${bank.color}; color: ${bank.textColor || 'white'}">
                    ${bank.name.substring(0, 2)}
                </div>
                <div class="bank-name">${bank.name}</div>
            `;
            bankOption.addEventListener('click', () => selectBank(bank.id));
            bankGrid.appendChild(bankOption);
        });
        
        if (RUSSIAN_BANKS.length > 0) {
            selectBank(RUSSIAN_BANKS[0].id);
        }
    }
    
    function selectBank(bankId) {
        selectedBank = bankId;
        
        document.querySelectorAll('.bank-option').forEach(item => {
            item.classList.remove('active');
        });
        
        const selectedItem = document.querySelector(`.bank-option[data-bank-id="${bankId}"]`);
        if (selectedItem) {
            selectedItem.classList.add('active');
        }
    }
    
    function selectPaymentMethod(method) {
        selectedPaymentMethod = method;
        
        document.querySelectorAll('.payment-method').forEach(item => {
            item.classList.remove('active');
        });
        
        const selectedItem = document.querySelectorAll('.payment-method')[method === 'card' ? 0 : 1];
        if (selectedItem) {
            selectedItem.classList.add('active');
        }
        
        showNotification('–í–Ω–∏–º–∞–Ω–∏–µ', '–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ.', 'warning');
    }
    
    function selectWithdrawMethod(method) {
        selectedWithdrawMethod = method;
        
        document.querySelectorAll('.method-switch').forEach(item => {
            item.classList.remove('active');
        });
        
        document.querySelectorAll('.method-switch')[method === 'card' ? 0 : 1].classList.add('active');
        
        document.querySelectorAll('.withdraw-method-block').forEach(block => {
            block.classList.remove('active');
        });
        
        if (method === 'card') {
            document.getElementById('card-withdraw-block').classList.add('active');
            document.getElementById('withdraw-button').innerHTML = '<i class="fas fa-wallet"></i> –í—ã–≤–µ—Å—Ç–∏ –Ω–∞ –∫–∞—Ä—Ç—É';
            document.getElementById('card-number').required = true;
            document.getElementById('yoomoney-account').required = false;
        } else {
            document.getElementById('yoomoney-withdraw-block').classList.add('active');
            document.getElementById('withdraw-button').innerHTML = '<i class="fas fa-money-bill-wave"></i> –í—ã–≤–µ—Å—Ç–∏ –Ω–∞ –ÆMoney';
            document.getElementById('card-number').required = false;
            document.getElementById('yoomoney-account').required = true;
        }
        
        updateWithdrawInfo();
    }
    
    function updateWithdrawInfo() {
        const amountInput = document.getElementById('withdraw-amount');
        const infoElement = document.getElementById('withdraw-info');
        
        if (!amountInput || !infoElement) return;
        
        const amount = parseFloat(amountInput.value) || 0;
        
        if (amount >= 100) {
            const fee = (amount * 0.015).toFixed(2);
            const total = (amount - parseFloat(fee)).toFixed(2);
            
            infoElement.innerHTML = `
                –ö–æ–º–∏—Å—Å–∏—è: ${fee.replace('.', ',')} ‚ÇΩ ‚Ä¢ –ö –ø–æ–ª—É—á–µ–Ω–∏—é: <strong>${total.replace('.', ',')} ‚ÇΩ</strong>
            `;
        } else {
            infoElement.innerHTML = '–ö–æ–º–∏—Å—Å–∏—è: 0 ‚ÇΩ ‚Ä¢ –ö –ø–æ–ª—É—á–µ–Ω–∏—é: 0 ‚ÇΩ';
        }
    }
    
    function loadNews() {
        const newsList = document.getElementById('news-list');
        if (!newsList) return;
        
        newsList.innerHTML = '';
        
        NEWS.forEach(news => {
            const newsItem = document.createElement('div');
            newsItem.className = `news-item ${news.type === 'warning' ? 'news-warning' : news.type === 'highlight' ? 'news-highlight' : ''}`;
            
            newsItem.innerHTML = `
                <div class="news-date">${news.date}</div>
                <div class="news-title">${news.title}</div>
                <div class="news-content">${news.content}</div>
            `;
            
            newsList.appendChild(newsItem);
        });
    }
    
    function openModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
            modal.classList.add('show');
            document.body.style.overflow = 'hidden';
        }
    }
    
    function closeModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
            modal.classList.remove('show');
            document.body.style.overflow = 'auto';
        }
    }
    
    function generateCheckCode() {
        const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
        let result = '';
        for (let i = 0; i < 10; i++) {
            result += chars.charAt(Math.floor(Math.random() * chars.length));
        }
        return result;
    }
    
    // ============ –û–ë–†–ê–ë–û–¢–ß–ò–ö –°–û–ó–î–ê–ù–ò–Ø –ß–ï–ö–ê ============
    document.getElementById('create-form')?.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        if (!currentUser) {
            showNotification('–û—à–∏–±–∫–∞', '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω', 'error');
            return;
        }
        
        const amount = parseFloat(document.getElementById('check-amount').value);
        
        if (amount < 10 || amount > 100000) {
            showNotification('–û—à–∏–±–∫–∞', '–°—É–º–º–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç 10 –¥–æ 100 000 ‚ÇΩ', 'error');
            return;
        }
        
        if (amount > userBalance) {
            showNotification('–û—à–∏–±–∫–∞', '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –±–∞–ª–∞–Ω—Å–µ', 'error');
            return;
        }
        
        try {
            const result = await createCheckFirebase(amount);
            
            if (result.success) {
                document.getElementById('new-check-code').textContent = result.code;
                document.getElementById('check-amount-display').textContent = amount.toFixed(2).replace('.', ',') + ' ‚ÇΩ';
                document.getElementById('check-result').classList.remove('hidden');
                
                showNotification('–ß–µ–∫ —Å–æ–∑–¥–∞–Ω', `–ß–µ–∫ –Ω–∞ —Å—É–º–º—É ${amount} ‚ÇΩ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω`, 'success');
                document.getElementById('check-amount').value = '';
            } else {
                showNotification('–û—à–∏–±–∫–∞', result.error, 'error');
            }
            
        } catch (error) {
            showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —á–µ–∫', 'error');
        }
    });
    
    // ============ –û–ë–†–ê–ë–û–¢–ß–ò–ö –ê–ö–¢–ò–í–ê–¶–ò–ò –ß–ï–ö–ê ============
    document.getElementById('checkout-form')?.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        if (!currentUser) {
            showNotification('–û—à–∏–±–∫–∞', '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω', 'error');
            return;
        }
        
        const checkCode = document.getElementById('check-code').value.toUpperCase().trim();
        
        if (checkCode.length !== 10) {
            showNotification('–û—à–∏–±–∫–∞', '–ö–æ–¥ —á–µ–∫–∞ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å 10 —Å–∏–º–≤–æ–ª–æ–≤', 'error');
            return;
        }
        
        try {
            const result = await activateCheckFirebase(checkCode);
            
            if (result.success) {
                showNotification('–£—Å–ø–µ—à–Ω–æ!', `–ß–µ–∫ –Ω–∞ —Å—É–º–º—É ${result.amount} ‚ÇΩ –æ–±–Ω–∞–ª–∏—á–µ–Ω`, 'success');
                document.getElementById('check-code').value = '';
            } else {
                showNotification('–û—à–∏–±–∫–∞', result.error, 'error');
            }
            
        } catch (error) {
            showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —á–µ–∫', 'error');
        }
    });
    
    function copyCheckCode() {
        const code = document.getElementById('new-check-code').textContent;
        navigator.clipboard.writeText(code).then(() => {
            showNotification('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ', '–ö–æ–¥ —á–µ–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞', 'success');
        });
    }
    
    // ============ –í–´–í–û–î –°–†–ï–î–°–¢–í ============
    document.getElementById('withdraw-form')?.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        if (!currentUser) {
            showNotification('–û—à–∏–±–∫–∞', '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω', 'error');
            return;
        }
        
        const amount = parseFloat(document.getElementById('withdraw-amount').value);
        
        if (amount < 100) {
            showNotification('–û—à–∏–±–∫–∞', '–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –≤—ã–≤–æ–¥–∞: 100 ‚ÇΩ', 'error');
            return;
        }
        
        if (amount > userBalance) {
            showNotification('–û—à–∏–±–∫–∞', '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –±–∞–ª–∞–Ω—Å–µ', 'error');
            return;
        }
        
        const fee = amount * 0.015;
        const total = amount - fee;
        
        if (selectedWithdrawMethod === 'card') {
            const cardNumber = document.getElementById('card-number').value.replace(/\s/g, '');
            
            if (!selectedBank) {
                showNotification('–û—à–∏–±–∫–∞', '–í—ã–±–µ—Ä–∏—Ç–µ –±–∞–Ω–∫ –¥–ª—è –≤—ã–≤–æ–¥–∞', 'error');
                return;
            }
            
            if (!cardNumber || cardNumber.length < 16 || cardNumber.length > 19 || !/^\d+$/.test(cardNumber)) {
                showNotification('–û—à–∏–±–∫–∞', '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä –∫–∞—Ä—Ç—ã', 'error');
                return;
            }
            
            const bank = RUSSIAN_BANKS.find(b => b.id === selectedBank);
            const bankName = bank ? bank.name : '–≤—ã–±—Ä–∞–Ω–Ω—ã–π –±–∞–Ω–∫';
            
            try {
                // –î–æ–±–∞–≤–ª—è–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤—ã–≤–æ–¥–∞
                await addTransactionToFirebase({
                    type: 'withdrawal',
                    amount: -amount,
                    method: 'card',
                    bank: bankName,
                    cardLast4: cardNumber.slice(-4),
                    fee: fee,
                    total: total,
                    status: 'processing',
                    description: `–í—ã–≤–æ–¥ –Ω–∞ –∫–∞—Ä—Ç—É ${bankName}`
                });
                
                showNotification('–ó–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞', 
                    `–ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–¥ ${amount.toFixed(2)} ‚ÇΩ –Ω–∞ –∫–∞—Ä—Ç—É ${bankName} –ø—Ä–∏–Ω—è—Ç–∞. –°—Ä–µ–¥—Å—Ç–≤–∞ –ø–æ—Å—Ç—É–ø—è—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 1-7 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π.`, 
                    'success');
                
                document.getElementById('card-number').value = '';
                document.getElementById('withdraw-amount').value = '';
                updateWithdrawInfo();
                
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ –≤—ã–≤–æ–¥', 'error');
            }
            
        } else {
            const yoomoneyAccount = document.getElementById('yoomoney-account').value.trim();
            
            if (!yoomoneyAccount || yoomoneyAccount.length < 13 || yoomoneyAccount.length > 20 || !/^\d+$/.test(yoomoneyAccount)) {
                showNotification('–û—à–∏–±–∫–∞', '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä –∫–æ—à–µ–ª—å–∫–∞ –ÆMoney', 'error');
                return;
            }
            
            try {
                // –î–æ–±–∞–≤–ª—è–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤—ã–≤–æ–¥–∞
                await addTransactionToFirebase({
                    type: 'withdrawal',
                    amount: -amount,
                    method: 'yoomoney',
                    account: yoomoneyAccount,
                    fee: fee,
                    total: total,
                    status: 'processing',
                    description: `–í—ã–≤–æ–¥ –Ω–∞ –ÆMoney`
                });
                
                showNotification('–ó–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞', 
                    `–ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–¥ ${amount.toFixed(2)} ‚ÇΩ –Ω–∞ –∫–æ—à–µ–ª–µ–∫ –ÆMoney –ø—Ä–∏–Ω—è—Ç–∞. –°—Ä–µ–¥—Å—Ç–≤–∞ –ø–æ—Å—Ç—É–ø—è—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 1-3 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π.`, 
                    'success');
                
                document.getElementById('yoomoney-account').value = '';
                document.getElementById('withdraw-amount').value = '';
                updateWithdrawInfo();
                
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ –≤—ã–≤–æ–¥', 'error');
            }
        }
    });
    
    // ============ –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–°–¢–û–†–ò–ò ============
    function updateHistory() {
        const historyList = document.getElementById('history-list');
        if (!historyList) return;
        
        historyList.innerHTML = '';
        
        // –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
        const sortedTransactions = [...userTransactions].sort((a, b) => {
            return new Date(b.timestamp) - new Date(a.timestamp);
        });
        
        if (sortedTransactions.length === 0) {
            historyList.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-file-invoice-dollar"></i>
                    <p>–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π –ø—É—Å—Ç–∞</p>
                    <p class="text-muted mt-2">–°–æ–≤–µ—Ä—à–∏—Ç–µ –ø–µ—Ä–≤—É—é –æ–ø–µ—Ä–∞—Ü–∏—é</p>
                </div>
            `;
            return;
        }
        
        sortedTransactions.forEach(transaction => {
            const item = document.createElement('div');
            item.className = 'history-item';
            
            if (transaction.type === 'withdrawal') {
                let methodInfo = '';
                if (transaction.method === 'card') {
                    methodInfo = `${transaction.bank} ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ${transaction.cardLast4 || '****'}`;
                } else {
                    const account = transaction.account || '';
                    const maskedAccount = account.length > 8 ? 
                        `${account.substring(0,4)}...${account.substring(account.length-4)}` : account;
                    methodInfo = `–ÆMoney ‚Ä¢ ${maskedAccount}`;
                }
                
                item.innerHTML = `
                    <div class="history-info">
                        <div class="history-title">${methodInfo}</div>
                        <div class="history-subtitle">${transaction.date} ${transaction.time} ‚Ä¢ –í—ã–≤–æ–¥</div>
                        <div class="history-status status-pending">–í –æ–±—Ä–∞–±–æ—Ç–∫–µ</div>
                    </div>
                    <div class="history-amount negative">-${transaction.amount?.toFixed(2) || '0.00'} ‚ÇΩ</div>
                `;
            } else if (transaction.type === 'check_created' || transaction.type === 'check_activated') {
                const isReceived = transaction.type === 'check_activated';
                const status = transaction.status === 'active' ? '–ê–∫—Ç–∏–≤–µ–Ω' : '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω';
                const statusClass = transaction.status === 'active' ? 'status-pending' : 'status-success';
                
                item.innerHTML = `
                    <div class="history-info">
                        <div class="history-title">–ß–µ–∫ ${transaction.checkCode}</div>
                        <div class="history-subtitle">${transaction.date} ${transaction.time} ‚Ä¢ ${isReceived ? '–ü–æ–ª—É—á–µ–Ω' : '–°–æ–∑–¥–∞–Ω'}</div>
                        <div class="history-status ${statusClass}">${status}</div>
                    </div>
                    <div class="history-amount ${isReceived ? 'positive' : 'negative'}">
                        ${isReceived ? '+' : '-'}${Math.abs(transaction.amount)?.toFixed(2) || '0.00'} ‚ÇΩ
                    </div>
                `;
            } else if (transaction.type === 'bonus') {
                item.innerHTML = `
                    <div class="history-info">
                        <div class="history-title">${transaction.description}</div>
                        <div class="history-subtitle">${transaction.date} ${transaction.time}</div>
                        <div class="history-status status-success">–ë–æ–Ω—É—Å</div>
                    </div>
                    <div class="history-amount positive">
                        +${transaction.amount?.toFixed(2) || '0.00'} ‚ÇΩ
                    </div>
                `;
            }
            
            historyList.appendChild(item);
        });
    }
    
    // ============ –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô ============
    document.getElementById('card-number')?.addEventListener('input', function(e) {
        let value = e.target.value.replace(/\D/g, '');
        value = value.replace(/(.{4})/g, '$1 ').trim();
        e.target.value = value.substring(0, 19);
    });
    
    document.getElementById('yoomoney-account')?.addEventListener('input', function(e) {
        let value = e.target.value.replace(/\D/g, '');
        e.target.value = value.substring(0, 20);
    });
    
    document.querySelectorAll('.payment-method').forEach(method => {
        method.addEventListener('click', function() {
            showNotification('–í–Ω–∏–º–∞–Ω–∏–µ', '–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ.', 'warning');
        });
    });
    
    // ============ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï ============
    document.addEventListener('DOMContentLoaded', async function() {
        try {
            tg.expand();
            tg.enableClosingConfirmation();
            initTheme();
            
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º Firestore –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            await initUserFirebase();
            initBanks();
            updateWithdrawInfo();
            loadNews();
            
            document.getElementById('withdraw-amount').addEventListener('input', updateWithdrawInfo);
            
        } catch (error) {
            console.error("–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:", error);
            showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ', 'error');
        }
        
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    closeModal(this.id);
                }
            });
        });
        
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                document.querySelectorAll('.modal.show').forEach(modal => {
                    closeModal(modal.id);
                });
            }
        });
        
        if (navigator.vibrate) {
            document.querySelectorAll('button, .tab, .bank-option, .footer-link, .payment-method, .method-switch').forEach(element => {
                element.addEventListener('click', function() {
                    navigator.vibrate(50);
                });
            });
        }
    });
    </script>
</body>
</html>